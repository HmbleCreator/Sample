"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/trpc/[trpc]";
exports.ids = ["pages/api/trpc/[trpc]"];
exports.modules = {

/***/ "@auth0/nextjs-auth0":
/*!**************************************!*\
  !*** external "@auth0/nextjs-auth0" ***!
  \**************************************/
/***/ ((module) => {

module.exports = require("@auth0/nextjs-auth0");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@google/generative-ai":
/*!****************************************!*\
  !*** external "@google/generative-ai" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@google/generative-ai");;

/***/ }),

/***/ "@trpc/server":
/*!*******************************!*\
  !*** external "@trpc/server" ***!
  \*******************************/
/***/ ((module) => {

module.exports = import("@trpc/server");;

/***/ }),

/***/ "@trpc/server/adapters/next":
/*!*********************************************!*\
  !*** external "@trpc/server/adapters/next" ***!
  \*********************************************/
/***/ ((module) => {

module.exports = import("@trpc/server/adapters/next");;

/***/ }),

/***/ "superjson":
/*!****************************!*\
  !*** external "superjson" ***!
  \****************************/
/***/ ((module) => {

module.exports = import("superjson");;

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ }),

/***/ "(api)/./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrpc%2F%5Btrpc%5D&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Ftrpc%2F%5Btrpc%5D.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrpc%2F%5Btrpc%5D&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Ftrpc%2F%5Btrpc%5D.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_trpc_trpc_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/pages/api/trpc/[trpc].ts */ \"(api)/./src/pages/api/trpc/[trpc].ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_trpc_trpc_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_trpc_trpc_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_trpc_trpc_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_trpc_trpc_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/trpc/[trpc]\",\n        pathname: \"/api/trpc/[trpc]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_trpc_trpc_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4wLjRfQGJhYmVsK2NvcmVANy4yOC4wX3JlYWN0LWRvbUAxOC4yLjBfcmVhY3RAMTguMi4wX19yZWFjdEAxOC4yLjAvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1yb3V0ZS1sb2FkZXIvaW5kZXguanM/a2luZD1QQUdFU19BUEkmcGFnZT0lMkZhcGklMkZ0cnBjJTJGJTVCdHJwYyU1RCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnNyYyUyRnBhZ2VzJTJGYXBpJTJGdHJwYyUyRiU1QnRycGMlNUQudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDMkQ7QUFDM0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHdEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyx3REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGF0Z3B0LWNsb25lLz8zNzJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmMvcGFnZXMvYXBpL3RycGMvW3RycGNdLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdHJwYy9bdHJwY11cIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90cnBjL1t0cnBjXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrpc%2F%5Btrpc%5D&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Ftrpc%2F%5Btrpc%5D.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/auth0.config.ts":
/*!*****************************!*\
  !*** ./src/auth0.config.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   auth0Config: () => (/* binding */ auth0Config),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   getUser: () => (/* binding */ getUser),\n/* harmony export */   refreshSession: () => (/* binding */ refreshSession)\n/* harmony export */ });\n/* harmony import */ var _auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @auth0/nextjs-auth0 */ \"@auth0/nextjs-auth0\");\n/* harmony import */ var _auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\n * Configuration for Auth0 session and token management\n */ const auth0Config = {\n    // Session configuration\n    session: {\n        // Absolute lifetime of the session in seconds (7 days)\n        absoluteDuration: 60 * 60 * 24 * 7,\n        // Session idle timeout in seconds (1 day)\n        idleTimeout: 60 * 60 * 24,\n        // How often to refresh the session in seconds (1 hour)\n        rollingDuration: 60 * 60\n    },\n    // Auth0 configuration\n    auth0: {\n        // Required scopes for your application\n        scope: \"openid profile email offline_access\",\n        // Enable refresh tokens\n        useRefreshTokens: true,\n        // Refresh tokens are used to fetch new tokens from the Auth0 server\n        refreshInterval: 300\n    }\n};\n/**\n * Gets the current session with extended type information\n */ async function getSession(req, res) {\n    try {\n        const session = await (0,_auth0_nextjs_auth0__WEBPACK_IMPORTED_MODULE_0__.getSession)(req, res);\n        // Log session info for debugging (without sensitive data)\n        if (session) {\n            console.log(\"Auth0 Session:\", {\n                hasIdToken: !!session.idToken,\n                hasAccessToken: !!session.accessToken,\n                hasRefreshToken: !!session.refreshToken,\n                user: session.user ? {\n                    sub: session.user.sub,\n                    email: session.user.email\n                } : null\n            });\n        }\n        return session;\n    } catch (error) {\n        console.error(\"Error getting Auth0 session:\", error);\n        return null;\n    }\n}\n/**\n * Gets the current user from the session\n */ async function getUser(req, res) {\n    const session = await getSession(req, res);\n    return session?.user || null;\n}\n/**\n * Refreshes the Auth0 session using the refresh token\n */ async function refreshSession(req, res) {\n    try {\n        // Get the current session\n        const session = await getSession(req, res);\n        if (!session?.refreshToken) {\n            console.warn(\"No refresh token available in session\");\n            return null;\n        }\n        // Call the Auth0 token endpoint to refresh the token\n        const tokenEndpoint = `https://${process.env.AUTH0_ISSUER_BASE_URL}/oauth/token`;\n        const response = await fetch(tokenEndpoint, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n                grant_type: \"refresh_token\",\n                client_id: process.env.AUTH0_CLIENT_ID,\n                client_secret: process.env.AUTH0_CLIENT_SECRET,\n                refresh_token: session.refreshToken\n            })\n        });\n        if (!response.ok) {\n            const error = await response.text();\n            console.error(\"Failed to refresh Auth0 session:\", error);\n            return null;\n        }\n        const data = await response.json();\n        // Update the session with the new tokens\n        const updatedSession = {\n            ...session,\n            idToken: data.id_token,\n            accessToken: data.access_token,\n            refreshToken: data.refresh_token || session.refreshToken\n        };\n        // TODO: Update the session in the session store\n        // This requires access to the session store, which depends on your Auth0 setup\n        return updatedSession;\n    } catch (error) {\n        console.error(\"Error refreshing Auth0 session:\", error);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU87UUFDZFgsUUFBUVcsS0FBSyxDQUFDLG1DQUFtQ0E7UUFDakQsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGF0Z3B0LWNsb25lLy4vc3JjL2F1dGgwLmNvbmZpZy50cz85ZDE0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFNlc3Npb24gYXMgZ2V0QXV0aDBTZXNzaW9uLCBTZXNzaW9uIH0gZnJvbSAnQGF1dGgwL25leHRqcy1hdXRoMCc7XG5pbXBvcnQgeyBHZXRTZXJ2ZXJTaWRlUHJvcHNDb250ZXh0LCBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5cbi8vIERlZmluZSB0aGUgc2hhcGUgb2YgdGhlIHVzZXIgb2JqZWN0IGZyb20gQXV0aDBcbnR5cGUgQXV0aDBVc2VyID0ge1xuICBzdWI6IHN0cmluZztcbiAgZW1haWw/OiBzdHJpbmc7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIFtrZXk6IHN0cmluZ106IGFueTsgLy8gQWxsb3cgZm9yIGFkZGl0aW9uYWwgcHJvcGVydGllc1xufTtcblxuLyoqXG4gKiBFeHRlbmRlZCBTZXNzaW9uIHR5cGUgdGhhdCBpbmNsdWRlcyBhZGRpdGlvbmFsIHRva2VuIGluZm9ybWF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRXh0ZW5kZWRTZXNzaW9uIGV4dGVuZHMgT21pdDxTZXNzaW9uLCAndXNlcic+IHtcbiAgaWRUb2tlbj86IHN0cmluZztcbiAgYWNjZXNzVG9rZW4/OiBzdHJpbmc7XG4gIHJlZnJlc2hUb2tlbj86IHN0cmluZztcbiAgdXNlcj86IEF1dGgwVXNlciB8IG51bGw7XG59XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBmb3IgQXV0aDAgc2Vzc2lvbiBhbmQgdG9rZW4gbWFuYWdlbWVudFxuICovXG5leHBvcnQgY29uc3QgYXV0aDBDb25maWcgPSB7XG4gIC8vIFNlc3Npb24gY29uZmlndXJhdGlvblxuICBzZXNzaW9uOiB7XG4gICAgLy8gQWJzb2x1dGUgbGlmZXRpbWUgb2YgdGhlIHNlc3Npb24gaW4gc2Vjb25kcyAoNyBkYXlzKVxuICAgIGFic29sdXRlRHVyYXRpb246IDYwICogNjAgKiAyNCAqIDcsXG4gICAgLy8gU2Vzc2lvbiBpZGxlIHRpbWVvdXQgaW4gc2Vjb25kcyAoMSBkYXkpXG4gICAgaWRsZVRpbWVvdXQ6IDYwICogNjAgKiAyNCxcbiAgICAvLyBIb3cgb2Z0ZW4gdG8gcmVmcmVzaCB0aGUgc2Vzc2lvbiBpbiBzZWNvbmRzICgxIGhvdXIpXG4gICAgcm9sbGluZ0R1cmF0aW9uOiA2MCAqIDYwLFxuICB9LFxuICAvLyBBdXRoMCBjb25maWd1cmF0aW9uXG4gIGF1dGgwOiB7XG4gICAgLy8gUmVxdWlyZWQgc2NvcGVzIGZvciB5b3VyIGFwcGxpY2F0aW9uXG4gICAgc2NvcGU6ICdvcGVuaWQgcHJvZmlsZSBlbWFpbCBvZmZsaW5lX2FjY2VzcycsXG4gICAgLy8gRW5hYmxlIHJlZnJlc2ggdG9rZW5zXG4gICAgdXNlUmVmcmVzaFRva2VuczogdHJ1ZSxcbiAgICAvLyBSZWZyZXNoIHRva2VucyBhcmUgdXNlZCB0byBmZXRjaCBuZXcgdG9rZW5zIGZyb20gdGhlIEF1dGgwIHNlcnZlclxuICAgIHJlZnJlc2hJbnRlcnZhbDogMzAwLCAvLyA1IG1pbnV0ZXNcbiAgfSxcbn07XG5cbi8qKlxuICogR2V0cyB0aGUgY3VycmVudCBzZXNzaW9uIHdpdGggZXh0ZW5kZWQgdHlwZSBpbmZvcm1hdGlvblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2Vzc2lvbihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCB8IEdldFNlcnZlclNpZGVQcm9wc0NvbnRleHRbJ3JlcSddLFxuICByZXM6IE5leHRBcGlSZXNwb25zZSB8IEdldFNlcnZlclNpZGVQcm9wc0NvbnRleHRbJ3JlcyddXG4pOiBQcm9taXNlPEV4dGVuZGVkU2Vzc2lvbiB8IG51bGwgfCB1bmRlZmluZWQ+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0QXV0aDBTZXNzaW9uKHJlcSwgcmVzKTtcbiAgICBcbiAgICAvLyBMb2cgc2Vzc2lvbiBpbmZvIGZvciBkZWJ1Z2dpbmcgKHdpdGhvdXQgc2Vuc2l0aXZlIGRhdGEpXG4gICAgaWYgKHNlc3Npb24pIHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoMCBTZXNzaW9uOicsIHtcbiAgICAgICAgaGFzSWRUb2tlbjogISFzZXNzaW9uLmlkVG9rZW4sXG4gICAgICAgIGhhc0FjY2Vzc1Rva2VuOiAhIXNlc3Npb24uYWNjZXNzVG9rZW4sXG4gICAgICAgIGhhc1JlZnJlc2hUb2tlbjogISFzZXNzaW9uLnJlZnJlc2hUb2tlbixcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyID8geyBzdWI6IHNlc3Npb24udXNlci5zdWIsIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwgfSA6IG51bGwsXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHNlc3Npb24gYXMgRXh0ZW5kZWRTZXNzaW9uO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgQXV0aDAgc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXRzIHRoZSBjdXJyZW50IHVzZXIgZnJvbSB0aGUgc2Vzc2lvblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlcihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCB8IEdldFNlcnZlclNpZGVQcm9wc0NvbnRleHRbJ3JlcSddLFxuICByZXM6IE5leHRBcGlSZXNwb25zZSB8IEdldFNlcnZlclNpZGVQcm9wc0NvbnRleHRbJ3JlcyddXG4pOiBQcm9taXNlPEV4dGVuZGVkU2Vzc2lvblsndXNlciddIHwgbnVsbD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbihyZXEsIHJlcyk7XG4gIHJldHVybiBzZXNzaW9uPy51c2VyIHx8IG51bGw7XG59XG5cbi8qKlxuICogUmVmcmVzaGVzIHRoZSBBdXRoMCBzZXNzaW9uIHVzaW5nIHRoZSByZWZyZXNoIHRva2VuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWZyZXNoU2Vzc2lvbihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCB8IEdldFNlcnZlclNpZGVQcm9wc0NvbnRleHRbJ3JlcSddLFxuICByZXM6IE5leHRBcGlSZXNwb25zZSB8IEdldFNlcnZlclNpZGVQcm9wc0NvbnRleHRbJ3JlcyddXG4pOiBQcm9taXNlPEV4dGVuZGVkU2Vzc2lvbiB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgc2Vzc2lvblxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKHJlcSwgcmVzKTtcbiAgICBcbiAgICBpZiAoIXNlc3Npb24/LnJlZnJlc2hUb2tlbikge1xuICAgICAgY29uc29sZS53YXJuKCdObyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZSBpbiBzZXNzaW9uJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBDYWxsIHRoZSBBdXRoMCB0b2tlbiBlbmRwb2ludCB0byByZWZyZXNoIHRoZSB0b2tlblxuICAgIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBgaHR0cHM6Ly8ke3Byb2Nlc3MuZW52LkFVVEgwX0lTU1VFUl9CQVNFX1VSTH0vb2F1dGgvdG9rZW5gO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBncmFudF90eXBlOiAncmVmcmVzaF90b2tlbicsXG4gICAgICAgIGNsaWVudF9pZDogcHJvY2Vzcy5lbnYuQVVUSDBfQ0xJRU5UX0lELFxuICAgICAgICBjbGllbnRfc2VjcmV0OiBwcm9jZXNzLmVudi5BVVRIMF9DTElFTlRfU0VDUkVULFxuICAgICAgICByZWZyZXNoX3Rva2VuOiBzZXNzaW9uLnJlZnJlc2hUb2tlbixcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVmcmVzaCBBdXRoMCBzZXNzaW9uOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgXG4gICAgLy8gVXBkYXRlIHRoZSBzZXNzaW9uIHdpdGggdGhlIG5ldyB0b2tlbnNcbiAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbjogRXh0ZW5kZWRTZXNzaW9uID0ge1xuICAgICAgLi4uc2Vzc2lvbixcbiAgICAgIGlkVG9rZW46IGRhdGEuaWRfdG9rZW4sXG4gICAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgICByZWZyZXNoVG9rZW46IGRhdGEucmVmcmVzaF90b2tlbiB8fCBzZXNzaW9uLnJlZnJlc2hUb2tlbiwgLy8gVXNlIG5ldyByZWZyZXNoIHRva2VuIGlmIHByb3ZpZGVkXG4gICAgfTtcblxuICAgIC8vIFRPRE86IFVwZGF0ZSB0aGUgc2Vzc2lvbiBpbiB0aGUgc2Vzc2lvbiBzdG9yZVxuICAgIC8vIFRoaXMgcmVxdWlyZXMgYWNjZXNzIHRvIHRoZSBzZXNzaW9uIHN0b3JlLCB3aGljaCBkZXBlbmRzIG9uIHlvdXIgQXV0aDAgc2V0dXBcbiAgICBcbiAgICByZXR1cm4gdXBkYXRlZFNlc3Npb247XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyBBdXRoMCBzZXNzaW9uOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImdldFNlc3Npb24iLCJnZXRBdXRoMFNlc3Npb24iLCJhdXRoMENvbmZpZyIsInNlc3Npb24iLCJhYnNvbHV0ZUR1cmF0aW9uIiwiaWRsZVRpbWVvdXQiLCJyb2xsaW5nRHVyYXRpb24iLCJhdXRoMCIsInNjb3BlIiwidXNlUmVmcmVzaFRva2VucyIsInJlZnJlc2hJbnRlcnZhbCIsInJlcSIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJoYXNJZFRva2VuIiwiaWRUb2tlbiIsImhhc0FjY2Vzc1Rva2VuIiwiYWNjZXNzVG9rZW4iLCJoYXNSZWZyZXNoVG9rZW4iLCJyZWZyZXNoVG9rZW4iLCJ1c2VyIiwic3ViIiwiZW1haWwiLCJlcnJvciIsImdldFVzZXIiLCJyZWZyZXNoU2Vzc2lvbiIsIndhcm4iLCJ0b2tlbkVuZHBvaW50IiwicHJvY2VzcyIsImVudiIsIkFVVEgwX0lTU1VFUl9CQVNFX1VSTCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJncmFudF90eXBlIiwiY2xpZW50X2lkIiwiQVVUSDBfQ0xJRU5UX0lEIiwiY2xpZW50X3NlY3JldCIsIkFVVEgwX0NMSUVOVF9TRUNSRVQiLCJyZWZyZXNoX3Rva2VuIiwib2siLCJ0ZXh0IiwiZGF0YSIsImpzb24iLCJ1cGRhdGVkU2Vzc2lvbiIsImlkX3Rva2VuIiwiYWNjZXNzX3Rva2VuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/auth0.config.ts\n");

/***/ }),

/***/ "(api)/./src/pages/api/trpc/[trpc].ts":
/*!**************************************!*\
  !*** ./src/pages/api/trpc/[trpc].ts ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _trpc_server_adapters_next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @trpc/server/adapters/next */ \"@trpc/server/adapters/next\");\n/* harmony import */ var _server_api_root__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/server/api/root */ \"(api)/./src/server/api/root.ts\");\n/* harmony import */ var _server_api_trpc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/server/api/trpc */ \"(api)/./src/server/api/trpc.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_trpc_server_adapters_next__WEBPACK_IMPORTED_MODULE_0__, _server_api_root__WEBPACK_IMPORTED_MODULE_1__, _server_api_trpc__WEBPACK_IMPORTED_MODULE_2__]);\n([_trpc_server_adapters_next__WEBPACK_IMPORTED_MODULE_0__, _server_api_root__WEBPACK_IMPORTED_MODULE_1__, _server_api_trpc__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,_trpc_server_adapters_next__WEBPACK_IMPORTED_MODULE_0__.createNextApiHandler)({\n    router: _server_api_root__WEBPACK_IMPORTED_MODULE_1__.appRouter,\n    createContext: _server_api_trpc__WEBPACK_IMPORTED_MODULE_2__.createTRPCContext,\n    onError:  true ? ({ path, error })=>{\n        console.error(`❌ tRPC failed on ${path ?? \"<no-path>\"}: ${error.message}`);\n    } : 0\n}));\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL3RycGMvW3RycGNdLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBa0U7QUFDcEI7QUFDUTtBQUV0RCxpRUFBZUEsZ0ZBQW9CQSxDQUFDO0lBQ2xDRyxRQUFRRix1REFBU0E7SUFDakJHLGVBQWVGLCtEQUFpQkE7SUFDaENHLFNBQ0VDLEtBQXlCLEdBQ3JCLENBQUMsRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUU7UUFDZEMsUUFBUUQsS0FBSyxDQUNYLENBQUMsaUJBQWlCLEVBQUVELFFBQVEsWUFBWSxFQUFFLEVBQUVDLE1BQU1FLE9BQU8sQ0FBQyxDQUFDO0lBRS9ELElBQ0FDLENBQVNBO0FBQ2pCLEVBQUUsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NoYXRncHQtY2xvbmUvLi9zcmMvcGFnZXMvYXBpL3RycGMvW3RycGNdLnRzP2NlNTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlTmV4dEFwaUhhbmRsZXIgfSBmcm9tICdAdHJwYy9zZXJ2ZXIvYWRhcHRlcnMvbmV4dCc7XG5pbXBvcnQgeyBhcHBSb3V0ZXIgfSBmcm9tICdAL3NlcnZlci9hcGkvcm9vdCc7XG5pbXBvcnQgeyBjcmVhdGVUUlBDQ29udGV4dCB9IGZyb20gJ0Avc2VydmVyL2FwaS90cnBjJztcblxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlTmV4dEFwaUhhbmRsZXIoe1xuICByb3V0ZXI6IGFwcFJvdXRlcixcbiAgY3JlYXRlQ29udGV4dDogY3JlYXRlVFJQQ0NvbnRleHQsXG4gIG9uRXJyb3I6XG4gICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCdcbiAgICAgID8gKHsgcGF0aCwgZXJyb3IgfSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgICBg4p2MIHRSUEMgZmFpbGVkIG9uICR7cGF0aCA/PyAnPG5vLXBhdGg+J306ICR7ZXJyb3IubWVzc2FnZX1gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgOiB1bmRlZmluZWQsXG59KTtcbiJdLCJuYW1lcyI6WyJjcmVhdGVOZXh0QXBpSGFuZGxlciIsImFwcFJvdXRlciIsImNyZWF0ZVRSUENDb250ZXh0Iiwicm91dGVyIiwiY3JlYXRlQ29udGV4dCIsIm9uRXJyb3IiLCJwcm9jZXNzIiwicGF0aCIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJ1bmRlZmluZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/trpc/[trpc].ts\n");

/***/ }),

/***/ "(api)/./src/server/api/root.ts":
/*!********************************!*\
  !*** ./src/server/api/root.ts ***!
  \********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appRouter: () => (/* binding */ appRouter)\n/* harmony export */ });\n/* harmony import */ var _trpc__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./trpc */ \"(api)/./src/server/api/trpc.ts\");\n/* harmony import */ var _routers_chat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./routers/chat */ \"(api)/./src/server/api/routers/chat.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_trpc__WEBPACK_IMPORTED_MODULE_0__, _routers_chat__WEBPACK_IMPORTED_MODULE_1__]);\n([_trpc__WEBPACK_IMPORTED_MODULE_0__, _routers_chat__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\nconst appRouter = (0,_trpc__WEBPACK_IMPORTED_MODULE_0__.createTRPCRouter)({\n    chat: _routers_chat__WEBPACK_IMPORTED_MODULE_1__.chatRouter\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvc2VydmVyL2FwaS9yb290LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwQztBQUNFO0FBRXJDLE1BQU1FLFlBQVlGLHVEQUFnQkEsQ0FBQztJQUN4Q0csTUFBTUYscURBQVVBO0FBQ2xCLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGF0Z3B0LWNsb25lLy4vc3JjL3NlcnZlci9hcGkvcm9vdC50cz9hOWI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVRSUENSb3V0ZXIgfSBmcm9tICcuL3RycGMnO1xuaW1wb3J0IHsgY2hhdFJvdXRlciB9IGZyb20gJy4vcm91dGVycy9jaGF0JztcblxuZXhwb3J0IGNvbnN0IGFwcFJvdXRlciA9IGNyZWF0ZVRSUENSb3V0ZXIoe1xuICBjaGF0OiBjaGF0Um91dGVyLFxufSk7XG5cbmV4cG9ydCB0eXBlIEFwcFJvdXRlciA9IHR5cGVvZiBhcHBSb3V0ZXI7XG4iXSwibmFtZXMiOlsiY3JlYXRlVFJQQ1JvdXRlciIsImNoYXRSb3V0ZXIiLCJhcHBSb3V0ZXIiLCJjaGF0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/server/api/root.ts\n");

/***/ }),

/***/ "(api)/./src/server/api/routers/chat.ts":
/*!****************************************!*\
  !*** ./src/server/api/routers/chat.ts ***!
  \****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chatRouter: () => (/* binding */ chatRouter)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"zod\");\n/* harmony import */ var _trpc_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @trpc/server */ \"@trpc/server\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @google/generative-ai */ \"@google/generative-ai\");\n/* harmony import */ var _trpc__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../trpc */ \"(api)/./src/server/api/trpc.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([zod__WEBPACK_IMPORTED_MODULE_0__, _trpc_server__WEBPACK_IMPORTED_MODULE_1__, _google_generative_ai__WEBPACK_IMPORTED_MODULE_2__, _trpc__WEBPACK_IMPORTED_MODULE_3__]);\n([zod__WEBPACK_IMPORTED_MODULE_0__, _trpc_server__WEBPACK_IMPORTED_MODULE_1__, _google_generative_ai__WEBPACK_IMPORTED_MODULE_2__, _trpc__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n// Initialize Google Gemini\n// Ensure the API key is loaded from your environment variables\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_2__.GoogleGenerativeAI(process.env.GOOGLE_GEMINI_API_KEY);\n// Model for text chat and understanding user-provided images.\nconst multiModalModel = genAI.getGenerativeModel({\n    model: \"gemini-2.5-flash\"\n});\n// Model specifically for generating new images from a text prompt.\nconst imageGenerationModel = genAI.getGenerativeModel({\n    model: \"gemini-2.0-flash-preview-image-generation\"\n});\nconst chatRouter = (0,_trpc__WEBPACK_IMPORTED_MODULE_3__.createTRPCRouter)({\n    sendMessage: _trpc__WEBPACK_IMPORTED_MODULE_3__.protectedProcedure.input(zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n        message: zod__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n        conversationId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n        imageBase64: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n        mimeType: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional()\n    })).mutation(async ({ input, ctx })=>{\n        const { message, conversationId, imageBase64, mimeType } = input;\n        if (!ctx.session?.user?.sub) {\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"UNAUTHORIZED\",\n                message: \"User not authenticated or missing user ID\"\n            });\n        }\n        const userId = ctx.session.user.sub;\n        let currentConversationId = conversationId;\n        if (!currentConversationId) {\n            console.log(\"Creating new conversation for user:\", userId);\n            const title = message.substring(0, 50);\n            try {\n                const { data: conversation, error } = await ctx.supabase.from(\"conversations\").insert({\n                    user_id: userId,\n                    title: title\n                }).select().single();\n                if (error) throw error;\n                if (!conversation) throw new Error(\"No conversation data returned from Supabase after creation\");\n                currentConversationId = conversation.id;\n            } catch (error) {\n                console.error(\"Error in conversation creation logic:\", error);\n                throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to create conversation\",\n                    cause: error instanceof Error ? error : new Error(String(error))\n                });\n            }\n        }\n        let aiResponseContent;\n        let aiMessageType = \"text\";\n        let userMessageType = \"text\";\n        try {\n            const isImageGenerationRequest = message.trim().toLowerCase().startsWith(\"/image\");\n            const hasUploadedImage = !!(imageBase64 && mimeType);\n            if (isImageGenerationRequest) {\n                // Case 1: User wants to generate an image with `/image`\n                const prompt = message.replace(/^\\/image\\s*/i, \"\").trim();\n                console.log(`Generating image for prompt: \"${prompt}\"`);\n                try {\n                    // Direct REST API call to Gemini 2.0 Flash Image Generation model\n                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-preview-image-generation:generateContent?key=${process.env.GOOGLE_GEMINI_API_KEY}`;\n                    const requestBody = {\n                        contents: [\n                            {\n                                role: \"user\",\n                                parts: [\n                                    {\n                                        text: prompt\n                                    }\n                                ]\n                            }\n                        ],\n                        generationConfig: {\n                            responseModalities: [\n                                \"TEXT\",\n                                \"IMAGE\"\n                            ]\n                        }\n                    };\n                    const response = await fetch(apiUrl, {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify(requestBody)\n                    });\n                    if (!response.ok) {\n                        const errorData = await response.json();\n                        throw new Error(`API request failed with status ${response.status}: ${JSON.stringify(errorData)}`);\n                    }\n                    const responseData = await response.json();\n                    console.log(\"Image generation response:\", JSON.stringify(responseData, null, 2));\n                    // Extract the image data from the response\n                    const imagePart = responseData.candidates?.[0]?.content?.parts?.find((part)=>part.inlineData?.mimeType?.startsWith(\"image/\"));\n                    if (imagePart?.inlineData) {\n                        const { mimeType, data } = imagePart.inlineData;\n                        aiResponseContent = `data:${mimeType};base64,${data}`;\n                        aiMessageType = \"image\";\n                        console.log(\"Successfully generated image with mimeType:\", mimeType);\n                    } else {\n                        // Check if there's any text content that might contain base64 data\n                        const textContent = responseData.candidates?.[0]?.content?.parts?.find((part)=>part.text)?.text;\n                        // If the text content looks like base64 data, try to format it as an image\n                        if (textContent && textContent.length > 1000 && /^[A-Za-z0-9+/=]+$/.test(textContent.trim())) {\n                            console.log(\"Found base64-like content in text response, formatting as image\");\n                            aiResponseContent = `data:image/png;base64,${textContent.trim()}`;\n                            aiMessageType = \"image\";\n                        } else {\n                            console.error(\"Image generation failed. Response:\", JSON.stringify(responseData, null, 2));\n                            aiResponseContent = textContent || \"I was unable to generate an image. The prompt may have been rejected. Please try again with a different prompt.\";\n                            aiMessageType = \"text\";\n                        }\n                    }\n                } catch (error) {\n                    console.error(\"Image generation error:\", error);\n                    // Fallback to text response if image generation fails\n                    const fallbackResult = await multiModalModel.generateContent(`I'm unable to generate an image right now. Here's a response to your prompt: ${prompt}`);\n                    const fallbackResponse = await fallbackResult.response;\n                    aiResponseContent = fallbackResponse.text();\n                    aiMessageType = \"text\";\n                }\n                userMessageType = \"image_prompt\";\n            } else if (hasUploadedImage) {\n                // Case 2: User uploaded an image and asked a question about it\n                // Use gemini-2.5-flash for image understanding and Q&A\n                console.log(`Generating response for prompt over image: \"${message}\"`);\n                const prompt = message;\n                const imagePart = {\n                    inlineData: {\n                        data: imageBase64,\n                        mimeType: mimeType\n                    }\n                };\n                const result = await multiModalModel.generateContent([\n                    prompt,\n                    imagePart\n                ]);\n                const response = await result.response;\n                aiResponseContent = response.text();\n                aiMessageType = \"text\";\n                userMessageType = \"image_query\";\n            } else {\n                // Case 3: Standard text-only message\n                // Retrieve conversation history for context\n                let conversationHistory = [];\n                if (currentConversationId) {\n                    const { data: messages, error } = await ctx.supabase.from(\"messages\").select(\"*\").eq(\"conversation_id\", currentConversationId).eq(\"user_id\", userId).order(\"created_at\", {\n                        ascending: true\n                    }).limit(20); // Limit to last 20 messages to avoid token limits\n                    if (!error && messages) {\n                        conversationHistory = messages;\n                    }\n                }\n                // Build conversation context for AI\n                const conversationParts = [];\n                // Add conversation history\n                for (const msg of conversationHistory){\n                    if (msg.message_type === \"text\") {\n                        conversationParts.push({\n                            role: msg.role === \"user\" ? \"user\" : \"model\",\n                            parts: [\n                                {\n                                    text: msg.content\n                                }\n                            ]\n                        });\n                    }\n                }\n                // Add current user message\n                conversationParts.push({\n                    role: \"user\",\n                    parts: [\n                        {\n                            text: message\n                        }\n                    ]\n                });\n                console.log(`Generating response with ${conversationHistory.length} previous messages for context`);\n                // Use gemini-2.5-flash for text chat with conversation history\n                const result = await multiModalModel.generateContent({\n                    contents: conversationParts\n                });\n                const response = await result.response;\n                aiResponseContent = response.text();\n                aiMessageType = \"text\";\n                userMessageType = \"text\";\n            }\n        } catch (error) {\n            console.error(\"Error generating AI response:\", error);\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"INTERNAL_SERVER_ERROR\",\n                message: \"Failed to generate AI response\",\n                cause: error\n            });\n        }\n        // --- Save messages to database ---\n        try {\n            await ctx.supabase.from(\"messages\").insert({\n                content: message,\n                role: \"user\",\n                message_type: userMessageType,\n                user_id: userId,\n                conversation_id: currentConversationId\n            });\n            const { data: aiMessage, error: aiMessageError } = await ctx.supabase.from(\"messages\").insert({\n                content: aiResponseContent,\n                role: \"assistant\",\n                message_type: aiMessageType,\n                user_id: userId,\n                conversation_id: currentConversationId\n            }).select().single();\n            if (aiMessageError) throw aiMessageError;\n            return {\n                aiMessage,\n                conversationId: currentConversationId\n            };\n        } catch (error) {\n            console.error(\"Error saving messages to Supabase:\", error);\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"INTERNAL_SERVER_ERROR\",\n                message: \"Failed to save messages to the database.\",\n                cause: error\n            });\n        }\n    }),\n    getConversations: _trpc__WEBPACK_IMPORTED_MODULE_3__.protectedProcedure.query(async ({ ctx })=>{\n        if (!ctx.session?.user?.sub) {\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"UNAUTHORIZED\",\n                message: \"User not authenticated or missing user ID\"\n            });\n        }\n        const userId = ctx.session.user.sub;\n        const { data: conversations, error } = await ctx.supabase.from(\"conversations\").select(\"*\").eq(\"user_id\", userId).order(\"created_at\", {\n            ascending: false\n        });\n        if (error) {\n            console.error(\"Error fetching conversations:\", error);\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"INTERNAL_SERVER_ERROR\",\n                message: \"Could not fetch conversations.\"\n            });\n        }\n        return conversations || [];\n    }),\n    getMessages: _trpc__WEBPACK_IMPORTED_MODULE_3__.protectedProcedure.input(zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n        conversationId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string()\n    })).query(async ({ input, ctx })=>{\n        const { conversationId } = input;\n        if (!ctx.session?.user?.sub) {\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"UNAUTHORIZED\",\n                message: \"User not authenticated or missing user ID\"\n            });\n        }\n        const userId = ctx.session.user.sub;\n        const { data: messages, error } = await ctx.supabase.from(\"messages\").select(\"*\").eq(\"conversation_id\", conversationId).eq(\"user_id\", userId).order(\"created_at\", {\n            ascending: true\n        });\n        if (error) {\n            console.error(\"Error fetching messages:\", error);\n            throw new _trpc_server__WEBPACK_IMPORTED_MODULE_1__.TRPCError({\n                code: \"INTERNAL_SERVER_ERROR\",\n                message: \"Could not fetch messages.\"\n            });\n        }\n        return messages || [];\n    })\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxPQUFPLENBQUNDLElBQUksQ0FBQ0MsR0FBRztRQUNuQyxNQUFNLEVBQUVRLE1BQU15RCxRQUFRLEVBQUV2RCxLQUFLLEVBQUUsR0FBRyxNQUFNYixJQUFJYyxRQUFRLENBQ2pEQyxJQUFJLENBQUMsWUFDTEcsTUFBTSxDQUFDLEtBQ1BtRCxFQUFFLENBQUMsbUJBQW1CMUUsZ0JBQ3RCMEUsRUFBRSxDQUFDLFdBQVdoRSxRQUNkaUUsS0FBSyxDQUFDLGNBQWM7WUFBRUMsV0FBVztRQUFLO1FBQ3pDLElBQUkxRCxPQUFPO1lBQ1ROLFFBQVFNLEtBQUssQ0FBQyw0QkFBNEJBO1lBQzFDLE1BQU0sSUFBSXBDLG1EQUFTQSxDQUFDO2dCQUFFMkIsTUFBTTtnQkFBeUJYLFNBQVM7WUFBMkI7UUFDM0Y7UUFDQSxPQUFPMkUsWUFBWSxFQUFFO0lBQ3ZCO0FBQ0osR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2NoYXRncHQtY2xvbmUvLi9zcmMvc2VydmVyL2FwaS9yb3V0ZXJzL2NoYXQudHM/ZTkxMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcbmltcG9ydCB7IFRSUENFcnJvciB9IGZyb20gJ0B0cnBjL3NlcnZlcic7XG5pbXBvcnQgeyBHb29nbGVHZW5lcmF0aXZlQUksIFBhcnQgfSBmcm9tICdAZ29vZ2xlL2dlbmVyYXRpdmUtYWknO1xuaW1wb3J0IHsgY3JlYXRlVFJQQ1JvdXRlciwgcHJvdGVjdGVkUHJvY2VkdXJlIH0gZnJvbSAnLi4vdHJwYyc7XG5cbi8vIEluaXRpYWxpemUgR29vZ2xlIEdlbWluaVxuLy8gRW5zdXJlIHRoZSBBUEkga2V5IGlzIGxvYWRlZCBmcm9tIHlvdXIgZW52aXJvbm1lbnQgdmFyaWFibGVzXG5jb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkocHJvY2Vzcy5lbnYuR09PR0xFX0dFTUlOSV9BUElfS0VZISk7XG5cbi8vIE1vZGVsIGZvciB0ZXh0IGNoYXQgYW5kIHVuZGVyc3RhbmRpbmcgdXNlci1wcm92aWRlZCBpbWFnZXMuXG5jb25zdCBtdWx0aU1vZGFsTW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBcbiAgbW9kZWw6ICdnZW1pbmktMi41LWZsYXNoJyxcbn0pO1xuXG4vLyBNb2RlbCBzcGVjaWZpY2FsbHkgZm9yIGdlbmVyYXRpbmcgbmV3IGltYWdlcyBmcm9tIGEgdGV4dCBwcm9tcHQuXG5jb25zdCBpbWFnZUdlbmVyYXRpb25Nb2RlbCA9IGdlbkFJLmdldEdlbmVyYXRpdmVNb2RlbCh7XG4gIG1vZGVsOiAnZ2VtaW5pLTIuMC1mbGFzaC1wcmV2aWV3LWltYWdlLWdlbmVyYXRpb24nLFxufSk7XG5cbmV4cG9ydCBjb25zdCBjaGF0Um91dGVyID0gY3JlYXRlVFJQQ1JvdXRlcih7XG4gIHNlbmRNZXNzYWdlOiBwcm90ZWN0ZWRQcm9jZWR1cmVcbiAgICAuaW5wdXQoei5vYmplY3Qoe1xuICAgICAgbWVzc2FnZTogei5zdHJpbmcoKSxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICBpbWFnZUJhc2U2NDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgbWltZVR5cGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICB9KSlcbiAgICAubXV0YXRpb24oYXN5bmMgKHsgaW5wdXQsIGN0eCB9KSA9PiB7XG4gICAgICBjb25zdCB7IG1lc3NhZ2UsIGNvbnZlcnNhdGlvbklkLCBpbWFnZUJhc2U2NCwgbWltZVR5cGUgfSA9IGlucHV0O1xuICAgICAgXG4gICAgICBpZiAoIWN0eC5zZXNzaW9uPy51c2VyPy5zdWIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFRSUENFcnJvcih7IGNvZGU6ICdVTkFVVEhPUklaRUQnLCBtZXNzYWdlOiAnVXNlciBub3QgYXV0aGVudGljYXRlZCBvciBtaXNzaW5nIHVzZXIgSUQnIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlcklkID0gY3R4LnNlc3Npb24udXNlci5zdWI7XG5cbiAgICAgIGxldCBjdXJyZW50Q29udmVyc2F0aW9uSWQgPSBjb252ZXJzYXRpb25JZDtcbiAgICAgIGlmICghY3VycmVudENvbnZlcnNhdGlvbklkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGluZyBuZXcgY29udmVyc2F0aW9uIGZvciB1c2VyOicsIHVzZXJJZCk7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gbWVzc2FnZS5zdWJzdHJpbmcoMCwgNTApO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YTogY29udmVyc2F0aW9uLCBlcnJvciB9ID0gYXdhaXQgY3R4LnN1cGFiYXNlXG4gICAgICAgICAgICAuZnJvbSgnY29udmVyc2F0aW9ucycpXG4gICAgICAgICAgICAuaW5zZXJ0KHsgdXNlcl9pZDogdXNlcklkLCB0aXRsZTogdGl0bGUgfSlcbiAgICAgICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgaWYgKCFjb252ZXJzYXRpb24pIHRocm93IG5ldyBFcnJvcignTm8gY29udmVyc2F0aW9uIGRhdGEgcmV0dXJuZWQgZnJvbSBTdXBhYmFzZSBhZnRlciBjcmVhdGlvbicpO1xuICAgICAgICAgIGN1cnJlbnRDb252ZXJzYXRpb25JZCA9IGNvbnZlcnNhdGlvbi5pZDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjb252ZXJzYXRpb24gY3JlYXRpb24gbG9naWM6JywgZXJyb3IpO1xuICAgICAgICAgIHRocm93IG5ldyBUUlBDRXJyb3IoeyBjb2RlOiAnSU5URVJOQUxfU0VSVkVSX0VSUk9SJywgbWVzc2FnZTogJ0ZhaWxlZCB0byBjcmVhdGUgY29udmVyc2F0aW9uJywgY2F1c2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvciA6IG5ldyBFcnJvcihTdHJpbmcoZXJyb3IpKSB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsZXQgYWlSZXNwb25zZUNvbnRlbnQ6IHN0cmluZztcbiAgICAgIGxldCBhaU1lc3NhZ2VUeXBlID0gJ3RleHQnO1xuICAgICAgbGV0IHVzZXJNZXNzYWdlVHlwZSA9ICd0ZXh0JztcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaXNJbWFnZUdlbmVyYXRpb25SZXF1ZXN0ID0gbWVzc2FnZS50cmltKCkudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKCcvaW1hZ2UnKTtcbiAgICAgICAgY29uc3QgaGFzVXBsb2FkZWRJbWFnZSA9ICEhKGltYWdlQmFzZTY0ICYmIG1pbWVUeXBlKTtcblxuICAgICAgICBpZiAoaXNJbWFnZUdlbmVyYXRpb25SZXF1ZXN0KSB7XG4gICAgICAgICAgLy8gQ2FzZSAxOiBVc2VyIHdhbnRzIHRvIGdlbmVyYXRlIGFuIGltYWdlIHdpdGggYC9pbWFnZWBcbiAgICAgICAgICBjb25zdCBwcm9tcHQgPSBtZXNzYWdlLnJlcGxhY2UoL15cXC9pbWFnZVxccyovaSwgJycpLnRyaW0oKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgR2VuZXJhdGluZyBpbWFnZSBmb3IgcHJvbXB0OiBcIiR7cHJvbXB0fVwiYCk7XG4gICAgICAgICAgXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIERpcmVjdCBSRVNUIEFQSSBjYWxsIHRvIEdlbWluaSAyLjAgRmxhc2ggSW1hZ2UgR2VuZXJhdGlvbiBtb2RlbFxuICAgICAgICAgICAgY29uc3QgYXBpVXJsID0gYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMvZ2VtaW5pLTIuMC1mbGFzaC1wcmV2aWV3LWltYWdlLWdlbmVyYXRpb246Z2VuZXJhdGVDb250ZW50P2tleT0ke3Byb2Nlc3MuZW52LkdPT0dMRV9HRU1JTklfQVBJX0tFWX1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHtcbiAgICAgICAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgICAgIHBhcnRzOiBbeyB0ZXh0OiBwcm9tcHQgfV1cbiAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgICAgICAgICByZXNwb25zZU1vZGFsaXRpZXM6IFtcIlRFWFRcIiwgXCJJTUFHRVwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCwge1xuICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFQSSByZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAke3Jlc3BvbnNlLnN0YXR1c306ICR7SlNPTi5zdHJpbmdpZnkoZXJyb3JEYXRhKX1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0ltYWdlIGdlbmVyYXRpb24gcmVzcG9uc2U6JywgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhLCBudWxsLCAyKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgdGhlIGltYWdlIGRhdGEgZnJvbSB0aGUgcmVzcG9uc2VcbiAgICAgICAgICAgIGNvbnN0IGltYWdlUGFydCA9IHJlc3BvbnNlRGF0YS5jYW5kaWRhdGVzPy5bMF0/LmNvbnRlbnQ/LnBhcnRzPy5maW5kKFxuICAgICAgICAgICAgICAocGFydDogYW55KSA9PiBwYXJ0LmlubGluZURhdGE/Lm1pbWVUeXBlPy5zdGFydHNXaXRoKCdpbWFnZS8nKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKGltYWdlUGFydD8uaW5saW5lRGF0YSkge1xuICAgICAgICAgICAgICBjb25zdCB7IG1pbWVUeXBlLCBkYXRhIH0gPSBpbWFnZVBhcnQuaW5saW5lRGF0YTtcbiAgICAgICAgICAgICAgYWlSZXNwb25zZUNvbnRlbnQgPSBgZGF0YToke21pbWVUeXBlfTtiYXNlNjQsJHtkYXRhfWA7XG4gICAgICAgICAgICAgIGFpTWVzc2FnZVR5cGUgPSAnaW1hZ2UnO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3VjY2Vzc2Z1bGx5IGdlbmVyYXRlZCBpbWFnZSB3aXRoIG1pbWVUeXBlOicsIG1pbWVUeXBlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYW55IHRleHQgY29udGVudCB0aGF0IG1pZ2h0IGNvbnRhaW4gYmFzZTY0IGRhdGFcbiAgICAgICAgICAgICAgY29uc3QgdGV4dENvbnRlbnQgPSByZXNwb25zZURhdGEuY2FuZGlkYXRlcz8uWzBdPy5jb250ZW50Py5wYXJ0cz8uZmluZChcbiAgICAgICAgICAgICAgICAocGFydDogYW55KSA9PiBwYXJ0LnRleHRcbiAgICAgICAgICAgICAgKT8udGV4dDtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIElmIHRoZSB0ZXh0IGNvbnRlbnQgbG9va3MgbGlrZSBiYXNlNjQgZGF0YSwgdHJ5IHRvIGZvcm1hdCBpdCBhcyBhbiBpbWFnZVxuICAgICAgICAgICAgICBpZiAodGV4dENvbnRlbnQgJiYgdGV4dENvbnRlbnQubGVuZ3RoID4gMTAwMCAmJiAvXltBLVphLXowLTkrLz1dKyQvLnRlc3QodGV4dENvbnRlbnQudHJpbSgpKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBiYXNlNjQtbGlrZSBjb250ZW50IGluIHRleHQgcmVzcG9uc2UsIGZvcm1hdHRpbmcgYXMgaW1hZ2UnKTtcbiAgICAgICAgICAgICAgICBhaVJlc3BvbnNlQ29udGVudCA9IGBkYXRhOmltYWdlL3BuZztiYXNlNjQsJHt0ZXh0Q29udGVudC50cmltKCl9YDtcbiAgICAgICAgICAgICAgICBhaU1lc3NhZ2VUeXBlID0gJ2ltYWdlJztcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbWFnZSBnZW5lcmF0aW9uIGZhaWxlZC4gUmVzcG9uc2U6JywgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhLCBudWxsLCAyKSk7XG4gICAgICAgICAgICAgICAgYWlSZXNwb25zZUNvbnRlbnQgPSB0ZXh0Q29udGVudCB8fCBcIkkgd2FzIHVuYWJsZSB0byBnZW5lcmF0ZSBhbiBpbWFnZS4gVGhlIHByb21wdCBtYXkgaGF2ZSBiZWVuIHJlamVjdGVkLiBQbGVhc2UgdHJ5IGFnYWluIHdpdGggYSBkaWZmZXJlbnQgcHJvbXB0LlwiO1xuICAgICAgICAgICAgICAgIGFpTWVzc2FnZVR5cGUgPSAndGV4dCc7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignSW1hZ2UgZ2VuZXJhdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICAvLyBGYWxsYmFjayB0byB0ZXh0IHJlc3BvbnNlIGlmIGltYWdlIGdlbmVyYXRpb24gZmFpbHNcbiAgICAgICAgICAgIGNvbnN0IGZhbGxiYWNrUmVzdWx0ID0gYXdhaXQgbXVsdGlNb2RhbE1vZGVsLmdlbmVyYXRlQ29udGVudChcbiAgICAgICAgICAgICAgYEknbSB1bmFibGUgdG8gZ2VuZXJhdGUgYW4gaW1hZ2UgcmlnaHQgbm93LiBIZXJlJ3MgYSByZXNwb25zZSB0byB5b3VyIHByb21wdDogJHtwcm9tcHR9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbnN0IGZhbGxiYWNrUmVzcG9uc2UgPSBhd2FpdCBmYWxsYmFja1Jlc3VsdC5yZXNwb25zZTtcbiAgICAgICAgICAgIGFpUmVzcG9uc2VDb250ZW50ID0gZmFsbGJhY2tSZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgICBhaU1lc3NhZ2VUeXBlID0gJ3RleHQnO1xuICAgICAgICAgIH1cbiAgICAgICAgICB1c2VyTWVzc2FnZVR5cGUgPSAnaW1hZ2VfcHJvbXB0JztcblxuICAgICAgICB9IGVsc2UgaWYgKGhhc1VwbG9hZGVkSW1hZ2UpIHtcbiAgICAgICAgICAvLyBDYXNlIDI6IFVzZXIgdXBsb2FkZWQgYW4gaW1hZ2UgYW5kIGFza2VkIGEgcXVlc3Rpb24gYWJvdXQgaXRcbiAgICAgICAgICAvLyBVc2UgZ2VtaW5pLTIuNS1mbGFzaCBmb3IgaW1hZ2UgdW5kZXJzdGFuZGluZyBhbmQgUSZBXG4gICAgICAgICAgY29uc29sZS5sb2coYEdlbmVyYXRpbmcgcmVzcG9uc2UgZm9yIHByb21wdCBvdmVyIGltYWdlOiBcIiR7bWVzc2FnZX1cImApO1xuICAgICAgICAgIGNvbnN0IHByb21wdCA9IG1lc3NhZ2U7XG4gICAgICAgICAgY29uc3QgaW1hZ2VQYXJ0OiBQYXJ0ID0ge1xuICAgICAgICAgICAgaW5saW5lRGF0YTogeyBkYXRhOiBpbWFnZUJhc2U2NCwgbWltZVR5cGU6IG1pbWVUeXBlIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtdWx0aU1vZGFsTW9kZWwuZ2VuZXJhdGVDb250ZW50KFtwcm9tcHQsIGltYWdlUGFydF0pO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgICAgIGFpUmVzcG9uc2VDb250ZW50ID0gcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgIGFpTWVzc2FnZVR5cGUgPSAndGV4dCc7XG4gICAgICAgICAgdXNlck1lc3NhZ2VUeXBlID0gJ2ltYWdlX3F1ZXJ5JztcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIENhc2UgMzogU3RhbmRhcmQgdGV4dC1vbmx5IG1lc3NhZ2VcbiAgICAgICAgICAvLyBSZXRyaWV2ZSBjb252ZXJzYXRpb24gaGlzdG9yeSBmb3IgY29udGV4dFxuICAgICAgICAgIGxldCBjb252ZXJzYXRpb25IaXN0b3J5OiBhbnlbXSA9IFtdO1xuICAgICAgICAgIGlmIChjdXJyZW50Q29udmVyc2F0aW9uSWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogbWVzc2FnZXMsIGVycm9yIH0gPSBhd2FpdCBjdHguc3VwYWJhc2VcbiAgICAgICAgICAgICAgLmZyb20oJ21lc3NhZ2VzJylcbiAgICAgICAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgICAgICAgIC5lcSgnY29udmVyc2F0aW9uX2lkJywgY3VycmVudENvbnZlcnNhdGlvbklkKVxuICAgICAgICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAgICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICAgICAgICAgIC5saW1pdCgyMCk7IC8vIExpbWl0IHRvIGxhc3QgMjAgbWVzc2FnZXMgdG8gYXZvaWQgdG9rZW4gbGltaXRzXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghZXJyb3IgJiYgbWVzc2FnZXMpIHtcbiAgICAgICAgICAgICAgY29udmVyc2F0aW9uSGlzdG9yeSA9IG1lc3NhZ2VzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEJ1aWxkIGNvbnZlcnNhdGlvbiBjb250ZXh0IGZvciBBSVxuICAgICAgICAgIGNvbnN0IGNvbnZlcnNhdGlvblBhcnRzID0gW107XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQWRkIGNvbnZlcnNhdGlvbiBoaXN0b3J5XG4gICAgICAgICAgZm9yIChjb25zdCBtc2cgb2YgY29udmVyc2F0aW9uSGlzdG9yeSkge1xuICAgICAgICAgICAgaWYgKG1zZy5tZXNzYWdlX3R5cGUgPT09ICd0ZXh0Jykge1xuICAgICAgICAgICAgICBjb252ZXJzYXRpb25QYXJ0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICByb2xlOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gJ3VzZXInIDogJ21vZGVsJyxcbiAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogbXNnLmNvbnRlbnQgfV1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIEFkZCBjdXJyZW50IHVzZXIgbWVzc2FnZVxuICAgICAgICAgIGNvbnZlcnNhdGlvblBhcnRzLnB1c2goe1xuICAgICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgICAgcGFydHM6IFt7IHRleHQ6IG1lc3NhZ2UgfV1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnNvbGUubG9nKGBHZW5lcmF0aW5nIHJlc3BvbnNlIHdpdGggJHtjb252ZXJzYXRpb25IaXN0b3J5Lmxlbmd0aH0gcHJldmlvdXMgbWVzc2FnZXMgZm9yIGNvbnRleHRgKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBVc2UgZ2VtaW5pLTIuNS1mbGFzaCBmb3IgdGV4dCBjaGF0IHdpdGggY29udmVyc2F0aW9uIGhpc3RvcnlcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtdWx0aU1vZGFsTW9kZWwuZ2VuZXJhdGVDb250ZW50KHtcbiAgICAgICAgICAgIGNvbnRlbnRzOiBjb252ZXJzYXRpb25QYXJ0c1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgICAgIGFpUmVzcG9uc2VDb250ZW50ID0gcmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgIGFpTWVzc2FnZVR5cGUgPSAndGV4dCc7XG4gICAgICAgICAgdXNlck1lc3NhZ2VUeXBlID0gJ3RleHQnO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIEFJIHJlc3BvbnNlOicsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IFRSUENFcnJvcih7IGNvZGU6ICdJTlRFUk5BTF9TRVJWRVJfRVJST1InLCBtZXNzYWdlOiAnRmFpbGVkIHRvIGdlbmVyYXRlIEFJIHJlc3BvbnNlJywgY2F1c2U6IGVycm9yIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyAtLS0gU2F2ZSBtZXNzYWdlcyB0byBkYXRhYmFzZSAtLS1cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGN0eC5zdXBhYmFzZS5mcm9tKCdtZXNzYWdlcycpLmluc2VydCh7XG4gICAgICAgICAgY29udGVudDogbWVzc2FnZSxcbiAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgbWVzc2FnZV90eXBlOiB1c2VyTWVzc2FnZVR5cGUsXG4gICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgIGNvbnZlcnNhdGlvbl9pZDogY3VycmVudENvbnZlcnNhdGlvbklkLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB7IGRhdGE6IGFpTWVzc2FnZSwgZXJyb3I6IGFpTWVzc2FnZUVycm9yIH0gPSBhd2FpdCBjdHguc3VwYWJhc2UuZnJvbSgnbWVzc2FnZXMnKS5pbnNlcnQoe1xuICAgICAgICAgIGNvbnRlbnQ6IGFpUmVzcG9uc2VDb250ZW50LFxuICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgIG1lc3NhZ2VfdHlwZTogYWlNZXNzYWdlVHlwZSxcbiAgICAgICAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgICAgICAgY29udmVyc2F0aW9uX2lkOiBjdXJyZW50Q29udmVyc2F0aW9uSWQsXG4gICAgICAgIH0pLnNlbGVjdCgpLnNpbmdsZSgpO1xuXG4gICAgICAgIGlmIChhaU1lc3NhZ2VFcnJvcikgdGhyb3cgYWlNZXNzYWdlRXJyb3I7XG5cbiAgICAgICAgcmV0dXJuIHsgYWlNZXNzYWdlLCBjb252ZXJzYXRpb25JZDogY3VycmVudENvbnZlcnNhdGlvbklkIH07XG4gICAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBtZXNzYWdlcyB0byBTdXBhYmFzZTonLCBlcnJvcik7XG4gICAgICAgIHRocm93IG5ldyBUUlBDRXJyb3IoeyBjb2RlOiAnSU5URVJOQUxfU0VSVkVSX0VSUk9SJywgbWVzc2FnZTogJ0ZhaWxlZCB0byBzYXZlIG1lc3NhZ2VzIHRvIHRoZSBkYXRhYmFzZS4nLCBjYXVzZTogZXJyb3IgfSk7XG4gICAgICB9XG4gICAgfSksXG5cbiAgZ2V0Q29udmVyc2F0aW9uczogcHJvdGVjdGVkUHJvY2VkdXJlXG4gICAgLnF1ZXJ5KGFzeW5jICh7IGN0eCB9KSA9PiB7XG4gICAgICBpZiAoIWN0eC5zZXNzaW9uPy51c2VyPy5zdWIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFRSUENFcnJvcih7IGNvZGU6ICdVTkFVVEhPUklaRUQnLCBtZXNzYWdlOiAnVXNlciBub3QgYXV0aGVudGljYXRlZCBvciBtaXNzaW5nIHVzZXIgSUQnIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlcklkID0gY3R4LnNlc3Npb24udXNlci5zdWI7XG4gICAgICBjb25zdCB7IGRhdGE6IGNvbnZlcnNhdGlvbnMsIGVycm9yIH0gPSBhd2FpdCBjdHguc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvbnZlcnNhdGlvbnMnKVxuICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGNvbnZlcnNhdGlvbnM6XCIsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IFRSUENFcnJvcih7IGNvZGU6ICdJTlRFUk5BTF9TRVJWRVJfRVJST1InLCBtZXNzYWdlOiAnQ291bGQgbm90IGZldGNoIGNvbnZlcnNhdGlvbnMuJ30pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbnZlcnNhdGlvbnMgfHwgW107XG4gICAgfSksXG5cbiAgZ2V0TWVzc2FnZXM6IHByb3RlY3RlZFByb2NlZHVyZVxuICAgIC5pbnB1dCh6Lm9iamVjdCh7XG4gICAgICBjb252ZXJzYXRpb25JZDogei5zdHJpbmcoKSxcbiAgICB9KSlcbiAgICAucXVlcnkoYXN5bmMgKHsgaW5wdXQsIGN0eCB9KSA9PiB7XG4gICAgICBjb25zdCB7IGNvbnZlcnNhdGlvbklkIH0gPSBpbnB1dDtcbiAgICAgIGlmICghY3R4LnNlc3Npb24/LnVzZXI/LnN1Yikge1xuICAgICAgICB0aHJvdyBuZXcgVFJQQ0Vycm9yKHsgY29kZTogJ1VOQVVUSE9SSVpFRCcsIG1lc3NhZ2U6ICdVc2VyIG5vdCBhdXRoZW50aWNhdGVkIG9yIG1pc3NpbmcgdXNlciBJRCcgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VySWQgPSBjdHguc2Vzc2lvbi51c2VyLnN1YjtcbiAgICAgIGNvbnN0IHsgZGF0YTogbWVzc2FnZXMsIGVycm9yIH0gPSBhd2FpdCBjdHguc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ21lc3NhZ2VzJylcbiAgICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAgIC5lcSgnY29udmVyc2F0aW9uX2lkJywgY29udmVyc2F0aW9uSWQpXG4gICAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IHRydWUgfSk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIG1lc3NhZ2VzOlwiLCBlcnJvcik7XG4gICAgICAgIHRocm93IG5ldyBUUlBDRXJyb3IoeyBjb2RlOiAnSU5URVJOQUxfU0VSVkVSX0VSUk9SJywgbWVzc2FnZTogJ0NvdWxkIG5vdCBmZXRjaCBtZXNzYWdlcy4nfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWVzc2FnZXMgfHwgW107XG4gICAgfSksXG59KTsiXSwibmFtZXMiOlsieiIsIlRSUENFcnJvciIsIkdvb2dsZUdlbmVyYXRpdmVBSSIsImNyZWF0ZVRSUENSb3V0ZXIiLCJwcm90ZWN0ZWRQcm9jZWR1cmUiLCJnZW5BSSIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfR0VNSU5JX0FQSV9LRVkiLCJtdWx0aU1vZGFsTW9kZWwiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJtb2RlbCIsImltYWdlR2VuZXJhdGlvbk1vZGVsIiwiY2hhdFJvdXRlciIsInNlbmRNZXNzYWdlIiwiaW5wdXQiLCJvYmplY3QiLCJtZXNzYWdlIiwic3RyaW5nIiwiY29udmVyc2F0aW9uSWQiLCJvcHRpb25hbCIsImltYWdlQmFzZTY0IiwibWltZVR5cGUiLCJtdXRhdGlvbiIsImN0eCIsInNlc3Npb24iLCJ1c2VyIiwic3ViIiwiY29kZSIsInVzZXJJZCIsImN1cnJlbnRDb252ZXJzYXRpb25JZCIsImNvbnNvbGUiLCJsb2ciLCJ0aXRsZSIsInN1YnN0cmluZyIsImRhdGEiLCJjb252ZXJzYXRpb24iLCJlcnJvciIsInN1cGFiYXNlIiwiZnJvbSIsImluc2VydCIsInVzZXJfaWQiLCJzZWxlY3QiLCJzaW5nbGUiLCJFcnJvciIsImlkIiwiY2F1c2UiLCJTdHJpbmciLCJhaVJlc3BvbnNlQ29udGVudCIsImFpTWVzc2FnZVR5cGUiLCJ1c2VyTWVzc2FnZVR5cGUiLCJpc0ltYWdlR2VuZXJhdGlvblJlcXVlc3QiLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJzdGFydHNXaXRoIiwiaGFzVXBsb2FkZWRJbWFnZSIsInByb21wdCIsInJlcGxhY2UiLCJhcGlVcmwiLCJyZXF1ZXN0Qm9keSIsImNvbnRlbnRzIiwicm9sZSIsInBhcnRzIiwidGV4dCIsImdlbmVyYXRpb25Db25maWciLCJyZXNwb25zZU1vZGFsaXRpZXMiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwib2siLCJlcnJvckRhdGEiLCJqc29uIiwic3RhdHVzIiwicmVzcG9uc2VEYXRhIiwiaW1hZ2VQYXJ0IiwiY2FuZGlkYXRlcyIsImNvbnRlbnQiLCJmaW5kIiwicGFydCIsImlubGluZURhdGEiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsInRlc3QiLCJmYWxsYmFja1Jlc3VsdCIsImdlbmVyYXRlQ29udGVudCIsImZhbGxiYWNrUmVzcG9uc2UiLCJyZXN1bHQiLCJjb252ZXJzYXRpb25IaXN0b3J5IiwibWVzc2FnZXMiLCJlcSIsIm9yZGVyIiwiYXNjZW5kaW5nIiwibGltaXQiLCJjb252ZXJzYXRpb25QYXJ0cyIsIm1zZyIsIm1lc3NhZ2VfdHlwZSIsInB1c2giLCJjb252ZXJzYXRpb25faWQiLCJhaU1lc3NhZ2UiLCJhaU1lc3NhZ2VFcnJvciIsImdldENvbnZlcnNhdGlvbnMiLCJxdWVyeSIsImNvbnZlcnNhdGlvbnMiLCJnZXRNZXNzYWdlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/server/api/routers/chat.ts\n");

/***/ }),

/***/ "(api)/./src/server/api/trpc.ts":
/*!********************************!*\
  !*** ./src/server/api/trpc.ts ***!
  \********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createTRPCContext: () => (/* binding */ createTRPCContext),\n/* harmony export */   createTRPCRouter: () => (/* binding */ createTRPCRouter),\n/* harmony export */   protectedProcedure: () => (/* binding */ protectedProcedure),\n/* harmony export */   publicProcedure: () => (/* binding */ publicProcedure)\n/* harmony export */ });\n/* harmony import */ var _trpc_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @trpc/server */ \"@trpc/server\");\n/* harmony import */ var _auth0_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/auth0.config */ \"(api)/./src/auth0.config.ts\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var superjson__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! superjson */ \"superjson\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"zod\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_trpc_server__WEBPACK_IMPORTED_MODULE_0__, superjson__WEBPACK_IMPORTED_MODULE_3__, zod__WEBPACK_IMPORTED_MODULE_4__]);\n([_trpc_server__WEBPACK_IMPORTED_MODULE_0__, superjson__WEBPACK_IMPORTED_MODULE_3__, zod__WEBPACK_IMPORTED_MODULE_4__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n// Verify required environment variables\nif (false) {}\nif (false) {}\n// Create a base Supabase client for unauthenticated operations\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://wbelghenamkkemtupbhl.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndiZWxnaGVuYW1ra2VtdHVwYmhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzNzMxODksImV4cCI6MjA2OTk0OTE4OX0.TquSHKemQ1fgfztYXnyMIVSnDRiGjJxBQ9dFyWUtdQM\", {\n    auth: {\n        persistSession: false,\n        autoRefreshToken: true,\n        detectSessionInUrl: false\n    }\n});\n// Create a new Supabase client with the user's ID token for RLS\nconst createSupabaseClient = async (session)=>{\n    if (!session?.idToken) {\n        // Return an unauthenticated client if no session or token\n        return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://wbelghenamkkemtupbhl.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndiZWxnaGVuYW1ra2VtdHVwYmhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzNzMxODksImV4cCI6MjA2OTk0OTE4OX0.TquSHKemQ1fgfztYXnyMIVSnDRiGjJxBQ9dFyWUtdQM\", {\n            auth: {\n                autoRefreshToken: false,\n                persistSession: false,\n                detectSessionInUrl: false\n            }\n        });\n    }\n    // Create authenticated client with the provided token\n    const client = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://wbelghenamkkemtupbhl.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndiZWxnaGVuYW1ra2VtdHVwYmhsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzNzMxODksImV4cCI6MjA2OTk0OTE4OX0.TquSHKemQ1fgfztYXnyMIVSnDRiGjJxBQ9dFyWUtdQM\", {\n        auth: {\n            autoRefreshToken: true,\n            persistSession: false,\n            detectSessionInUrl: false\n        },\n        global: {\n            headers: {\n                Authorization: `Bearer ${session.idToken}`\n            }\n        }\n    });\n    return client;\n};\n/**\n * Tests the Supabase connection and refreshes the session if needed\n */ async function testSupabaseConnection(client, session, req, res) {\n    if (!session?.idToken) {\n        return {\n            client,\n            session\n        };\n    }\n    try {\n        // Test the connection with a simple query\n        const { error } = await client.from(\"conversations\").select(\"*\").limit(1);\n        if (error) {\n            console.warn(\"Supabase connection test failed:\", error);\n            // If the error is due to an expired token, try to refresh it\n            if (error.code === \"PGRST301\" && session.refreshToken) {\n                console.log(\"Token expired, attempting to refresh...\");\n                const newSession = await (0,_auth0_config__WEBPACK_IMPORTED_MODULE_1__.refreshSession)(req, res);\n                if (newSession?.idToken) {\n                    console.log(\"Successfully refreshed Auth0 session\");\n                    // Create a new client with the refreshed token\n                    const newClient = await createSupabaseClient(newSession);\n                    return {\n                        client: newClient,\n                        session: newSession\n                    };\n                }\n            }\n        } else {\n            console.log(\"Successfully connected to Supabase with RLS\");\n        }\n    } catch (error) {\n        console.error(\"Error testing Supabase connection:\", error);\n    }\n    return {\n        client,\n        session\n    };\n}\nconst createTRPCContext = async (opts)=>{\n    const { req, res } = opts;\n    // Get the session with our custom configuration\n    let session = await (0,_auth0_config__WEBPACK_IMPORTED_MODULE_1__.getSession)(req, res);\n    // Log session information for debugging\n    console.log(\"Session data:\", JSON.stringify({\n        hasSession: !!session,\n        hasIdToken: !!(session?.idToken),\n        hasAccessToken: !!(session?.accessToken),\n        hasRefreshToken: !!(session?.refreshToken),\n        user: session?.user ? {\n            sub: session.user.sub,\n            email: session.user.email,\n            name: session.user.name\n        } : null\n    }, null, 2));\n    // Ensure session is properly typed and handle undefined case\n    const typedSession = session || null;\n    // Create a Supabase client with the current session\n    let client = await createSupabaseClient(typedSession);\n    // Test the connection and refresh the session if needed\n    const connectionResult = await testSupabaseConnection(client, typedSession, req, res);\n    client = connectionResult.client;\n    session = connectionResult.session;\n    return {\n        session,\n        supabase: client\n    };\n};\nconst t = _trpc_server__WEBPACK_IMPORTED_MODULE_0__.initTRPC.context().create({\n    transformer: superjson__WEBPACK_IMPORTED_MODULE_3__[\"default\"],\n    errorFormatter ({ shape, error }) {\n        return {\n            ...shape,\n            data: {\n                ...shape.data,\n                zodError: error.cause instanceof zod__WEBPACK_IMPORTED_MODULE_4__.ZodError ? error.cause.flatten() : null\n            }\n        };\n    }\n});\nconst createTRPCRouter = t.router;\nconst publicProcedure = t.procedure;\nconst enforceUserIsAuthed = t.middleware(({ ctx, next })=>{\n    if (!ctx.session || !ctx.session.user) {\n        throw new _trpc_server__WEBPACK_IMPORTED_MODULE_0__.TRPCError({\n            code: \"UNAUTHORIZED\"\n        });\n    }\n    return next({\n        ctx: {\n            session: {\n                ...ctx.session,\n                user: ctx.session.user\n            },\n            supabase: ctx.supabase\n        }\n    });\n});\nconst protectedProcedure = t.procedure.use(enforceUserIsAuthed);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxJQUFJN0MsbURBQVNBLENBQUM7WUFBRStCLE1BQU07UUFBZTtJQUM3QztJQUNBLE9BQU9xQyxLQUFLO1FBQ1ZELEtBQUs7WUFDSGpELFNBQVM7Z0JBQUUsR0FBR2lELElBQUlqRCxPQUFPO2dCQUFFMkIsTUFBTXNCLElBQUlqRCxPQUFPLENBQUMyQixJQUFJO1lBQUM7WUFDbERqQyxVQUFVdUQsSUFBSXZELFFBQVE7UUFDeEI7SUFDRjtBQUNGO0FBRU8sTUFBTXlELHFCQUFxQmxCLEVBQUVhLFNBQVMsQ0FBQ00sR0FBRyxDQUFDTCxxQkFBcUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGF0Z3B0LWNsb25lLy4vc3JjL3NlcnZlci9hcGkvdHJwYy50cz8xOTcyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluaXRUUlBDLCBUUlBDRXJyb3IgfSBmcm9tICdAdHJwYy9zZXJ2ZXInO1xuaW1wb3J0IHsgdHlwZSBDcmVhdGVOZXh0Q29udGV4dE9wdGlvbnMgfSBmcm9tICdAdHJwYy9zZXJ2ZXIvYWRhcHRlcnMvbmV4dCc7XG5pbXBvcnQgeyBTZXNzaW9uIH0gZnJvbSAnQGF1dGgwL25leHRqcy1hdXRoMCc7XG5pbXBvcnQgeyBhdXRoMENvbmZpZywgZ2V0U2Vzc2lvbiwgcmVmcmVzaFNlc3Npb24sIEV4dGVuZGVkU2Vzc2lvbiB9IGZyb20gJ0AvYXV0aDAuY29uZmlnJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5pbXBvcnQgc3VwZXJqc29uIGZyb20gJ3N1cGVyanNvbic7XG5pbXBvcnQgeyBab2RFcnJvciB9IGZyb20gJ3pvZCc7XG5cbi8vIFZlcmlmeSByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbmlmICghcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMKSB7XG4gIGNvbnNvbGUuZXJyb3IoJ01pc3NpbmcgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGVudmlyb25tZW50IHZhcmlhYmxlJyk7XG59XG5pZiAoIXByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZKSB7XG4gIGNvbnNvbGUuZXJyb3IoJ01pc3NpbmcgTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUnKTtcbn1cblxuLy8gQ3JlYXRlIGEgYmFzZSBTdXBhYmFzZSBjbGllbnQgZm9yIHVuYXV0aGVudGljYXRlZCBvcGVyYXRpb25zXG5jb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICB7XG4gICAgYXV0aDoge1xuICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLFxuICAgICAgYXV0b1JlZnJlc2hUb2tlbjogdHJ1ZSxcbiAgICAgIGRldGVjdFNlc3Npb25JblVybDogZmFsc2UsXG4gICAgfSxcbiAgfVxuKTtcblxuLy8gQ3JlYXRlIGEgbmV3IFN1cGFiYXNlIGNsaWVudCB3aXRoIHRoZSB1c2VyJ3MgSUQgdG9rZW4gZm9yIFJMU1xuY29uc3QgY3JlYXRlU3VwYWJhc2VDbGllbnQgPSBhc3luYyAoc2Vzc2lvbjogRXh0ZW5kZWRTZXNzaW9uIHwgbnVsbCkgPT4ge1xuICBpZiAoIXNlc3Npb24/LmlkVG9rZW4pIHtcbiAgICAvLyBSZXR1cm4gYW4gdW5hdXRoZW50aWNhdGVkIGNsaWVudCBpZiBubyBzZXNzaW9uIG9yIHRva2VuXG4gICAgcmV0dXJuIGNyZWF0ZUNsaWVudChcbiAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSEsXG4gICAgICB7XG4gICAgICAgIGF1dGg6IHtcbiAgICAgICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgICAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2UsXG4gICAgICAgICAgZGV0ZWN0U2Vzc2lvbkluVXJsOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgLy8gQ3JlYXRlIGF1dGhlbnRpY2F0ZWQgY2xpZW50IHdpdGggdGhlIHByb3ZpZGVkIHRva2VuXG4gIGNvbnN0IGNsaWVudCA9IGNyZWF0ZUNsaWVudChcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZISxcbiAgICB7XG4gICAgICBhdXRoOiB7XG4gICAgICAgIGF1dG9SZWZyZXNoVG9rZW46IHRydWUsXG4gICAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZSxcbiAgICAgICAgZGV0ZWN0U2Vzc2lvbkluVXJsOiBmYWxzZSxcbiAgICAgIH0sXG4gICAgICBnbG9iYWw6IHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtzZXNzaW9uLmlkVG9rZW59YCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICApO1xuXG4gIHJldHVybiBjbGllbnQ7XG59O1xuXG4vKipcbiAqIFRlc3RzIHRoZSBTdXBhYmFzZSBjb25uZWN0aW9uIGFuZCByZWZyZXNoZXMgdGhlIHNlc3Npb24gaWYgbmVlZGVkXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHRlc3RTdXBhYmFzZUNvbm5lY3Rpb24oY2xpZW50OiBhbnksIHNlc3Npb246IEV4dGVuZGVkU2Vzc2lvbiB8IG51bGwsIHJlcTogYW55LCByZXM6IGFueSk6IFByb21pc2U8eyBjbGllbnQ6IGFueTsgc2Vzc2lvbjogRXh0ZW5kZWRTZXNzaW9uIHwgbnVsbCB9PiB7XG4gIGlmICghc2Vzc2lvbj8uaWRUb2tlbikge1xuICAgIHJldHVybiB7IGNsaWVudCwgc2Vzc2lvbiB9O1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBUZXN0IHRoZSBjb25uZWN0aW9uIHdpdGggYSBzaW1wbGUgcXVlcnlcbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBjbGllbnRcbiAgICAgIC5mcm9tKCdjb252ZXJzYXRpb25zJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmxpbWl0KDEpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1N1cGFiYXNlIGNvbm5lY3Rpb24gdGVzdCBmYWlsZWQ6JywgZXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBJZiB0aGUgZXJyb3IgaXMgZHVlIHRvIGFuIGV4cGlyZWQgdG9rZW4sIHRyeSB0byByZWZyZXNoIGl0XG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1BHUlNUMzAxJyAmJiBzZXNzaW9uLnJlZnJlc2hUb2tlbikge1xuICAgICAgICBjb25zb2xlLmxvZygnVG9rZW4gZXhwaXJlZCwgYXR0ZW1wdGluZyB0byByZWZyZXNoLi4uJyk7XG4gICAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSBhd2FpdCByZWZyZXNoU2Vzc2lvbihyZXEsIHJlcyk7XG4gICAgICAgIFxuICAgICAgICBpZiAobmV3U2Vzc2lvbj8uaWRUb2tlbikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgcmVmcmVzaGVkIEF1dGgwIHNlc3Npb24nKTtcbiAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgY2xpZW50IHdpdGggdGhlIHJlZnJlc2hlZCB0b2tlblxuICAgICAgICAgIGNvbnN0IG5ld0NsaWVudCA9IGF3YWl0IGNyZWF0ZVN1cGFiYXNlQ2xpZW50KG5ld1Nlc3Npb24pO1xuICAgICAgICAgIHJldHVybiB7IGNsaWVudDogbmV3Q2xpZW50LCBzZXNzaW9uOiBuZXdTZXNzaW9uIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWxseSBjb25uZWN0ZWQgdG8gU3VwYWJhc2Ugd2l0aCBSTFMnKTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdGVzdGluZyBTdXBhYmFzZSBjb25uZWN0aW9uOicsIGVycm9yKTtcbiAgfVxuXG4gIHJldHVybiB7IGNsaWVudCwgc2Vzc2lvbiB9O1xufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlVFJQQ0NvbnRleHQgPSBhc3luYyAob3B0czogQ3JlYXRlTmV4dENvbnRleHRPcHRpb25zKSA9PiB7XG4gIGNvbnN0IHsgcmVxLCByZXMgfSA9IG9wdHM7XG4gIFxuICAvLyBHZXQgdGhlIHNlc3Npb24gd2l0aCBvdXIgY3VzdG9tIGNvbmZpZ3VyYXRpb25cbiAgbGV0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uKHJlcSwgcmVzKTtcbiAgXG4gIC8vIExvZyBzZXNzaW9uIGluZm9ybWF0aW9uIGZvciBkZWJ1Z2dpbmdcbiAgY29uc29sZS5sb2coJ1Nlc3Npb24gZGF0YTonLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgaGFzU2Vzc2lvbjogISFzZXNzaW9uLFxuICAgIGhhc0lkVG9rZW46ICEhKHNlc3Npb24/LmlkVG9rZW4pLFxuICAgIGhhc0FjY2Vzc1Rva2VuOiAhIShzZXNzaW9uPy5hY2Nlc3NUb2tlbiksXG4gICAgaGFzUmVmcmVzaFRva2VuOiAhIShzZXNzaW9uPy5yZWZyZXNoVG9rZW4pLFxuICAgIHVzZXI6IHNlc3Npb24/LnVzZXIgPyB7XG4gICAgICBzdWI6IHNlc3Npb24udXNlci5zdWIsXG4gICAgICBlbWFpbDogc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgbmFtZTogc2Vzc2lvbi51c2VyLm5hbWUsXG4gICAgfSA6IG51bGxcbiAgfSwgbnVsbCwgMikpO1xuXG4gICAgLy8gRW5zdXJlIHNlc3Npb24gaXMgcHJvcGVybHkgdHlwZWQgYW5kIGhhbmRsZSB1bmRlZmluZWQgY2FzZVxuICBjb25zdCB0eXBlZFNlc3Npb246IEV4dGVuZGVkU2Vzc2lvbiB8IG51bGwgPSBzZXNzaW9uIHx8IG51bGw7XG4gIFxuICAvLyBDcmVhdGUgYSBTdXBhYmFzZSBjbGllbnQgd2l0aCB0aGUgY3VycmVudCBzZXNzaW9uXG4gIGxldCBjbGllbnQgPSBhd2FpdCBjcmVhdGVTdXBhYmFzZUNsaWVudCh0eXBlZFNlc3Npb24pO1xuICBcbiAgLy8gVGVzdCB0aGUgY29ubmVjdGlvbiBhbmQgcmVmcmVzaCB0aGUgc2Vzc2lvbiBpZiBuZWVkZWRcbiAgY29uc3QgY29ubmVjdGlvblJlc3VsdCA9IGF3YWl0IHRlc3RTdXBhYmFzZUNvbm5lY3Rpb24oY2xpZW50LCB0eXBlZFNlc3Npb24sIHJlcSwgcmVzKTtcbiAgY2xpZW50ID0gY29ubmVjdGlvblJlc3VsdC5jbGllbnQ7XG4gIHNlc3Npb24gPSBjb25uZWN0aW9uUmVzdWx0LnNlc3Npb247XG5cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uLFxuICAgIHN1cGFiYXNlOiBjbGllbnQsXG4gIH07XG59O1xuXG5jb25zdCB0ID0gaW5pdFRSUEMuY29udGV4dDx0eXBlb2YgY3JlYXRlVFJQQ0NvbnRleHQ+KCkuY3JlYXRlKHtcbiAgdHJhbnNmb3JtZXI6IHN1cGVyanNvbixcbiAgZXJyb3JGb3JtYXR0ZXIoeyBzaGFwZSwgZXJyb3IgfSkge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5zaGFwZSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgLi4uc2hhcGUuZGF0YSxcbiAgICAgICAgem9kRXJyb3I6XG4gICAgICAgICAgZXJyb3IuY2F1c2UgaW5zdGFuY2VvZiBab2RFcnJvciA/IGVycm9yLmNhdXNlLmZsYXR0ZW4oKSA6IG51bGwsXG4gICAgICB9LFxuICAgIH07XG4gIH0sXG59KTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVRSUENSb3V0ZXIgPSB0LnJvdXRlcjtcblxuZXhwb3J0IGNvbnN0IHB1YmxpY1Byb2NlZHVyZSA9IHQucHJvY2VkdXJlO1xuXG5jb25zdCBlbmZvcmNlVXNlcklzQXV0aGVkID0gdC5taWRkbGV3YXJlKCh7IGN0eCwgbmV4dCB9KSA9PiB7XG4gIGlmICghY3R4LnNlc3Npb24gfHwgIWN0eC5zZXNzaW9uLnVzZXIpIHtcbiAgICB0aHJvdyBuZXcgVFJQQ0Vycm9yKHsgY29kZTogJ1VOQVVUSE9SSVpFRCcgfSk7XG4gIH1cbiAgcmV0dXJuIG5leHQoe1xuICAgIGN0eDoge1xuICAgICAgc2Vzc2lvbjogeyAuLi5jdHguc2Vzc2lvbiwgdXNlcjogY3R4LnNlc3Npb24udXNlciB9LFxuICAgICAgc3VwYWJhc2U6IGN0eC5zdXBhYmFzZSxcbiAgICB9LFxuICB9KTtcbn0pO1xuXG5leHBvcnQgY29uc3QgcHJvdGVjdGVkUHJvY2VkdXJlID0gdC5wcm9jZWR1cmUudXNlKGVuZm9yY2VVc2VySXNBdXRoZWQpO1xuIl0sIm5hbWVzIjpbImluaXRUUlBDIiwiVFJQQ0Vycm9yIiwiZ2V0U2Vzc2lvbiIsInJlZnJlc2hTZXNzaW9uIiwiY3JlYXRlQ2xpZW50Iiwic3VwZXJqc29uIiwiWm9kRXJyb3IiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiY29uc29sZSIsImVycm9yIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZSIsImF1dGgiLCJwZXJzaXN0U2Vzc2lvbiIsImF1dG9SZWZyZXNoVG9rZW4iLCJkZXRlY3RTZXNzaW9uSW5VcmwiLCJjcmVhdGVTdXBhYmFzZUNsaWVudCIsInNlc3Npb24iLCJpZFRva2VuIiwiY2xpZW50IiwiZ2xvYmFsIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJ0ZXN0U3VwYWJhc2VDb25uZWN0aW9uIiwicmVxIiwicmVzIiwiZnJvbSIsInNlbGVjdCIsImxpbWl0Iiwid2FybiIsImNvZGUiLCJyZWZyZXNoVG9rZW4iLCJsb2ciLCJuZXdTZXNzaW9uIiwibmV3Q2xpZW50IiwiY3JlYXRlVFJQQ0NvbnRleHQiLCJvcHRzIiwiSlNPTiIsInN0cmluZ2lmeSIsImhhc1Nlc3Npb24iLCJoYXNJZFRva2VuIiwiaGFzQWNjZXNzVG9rZW4iLCJhY2Nlc3NUb2tlbiIsImhhc1JlZnJlc2hUb2tlbiIsInVzZXIiLCJzdWIiLCJlbWFpbCIsIm5hbWUiLCJ0eXBlZFNlc3Npb24iLCJjb25uZWN0aW9uUmVzdWx0IiwidCIsImNvbnRleHQiLCJjcmVhdGUiLCJ0cmFuc2Zvcm1lciIsImVycm9yRm9ybWF0dGVyIiwic2hhcGUiLCJkYXRhIiwiem9kRXJyb3IiLCJjYXVzZSIsImZsYXR0ZW4iLCJjcmVhdGVUUlBDUm91dGVyIiwicm91dGVyIiwicHVibGljUHJvY2VkdXJlIiwicHJvY2VkdXJlIiwiZW5mb3JjZVVzZXJJc0F1dGhlZCIsIm1pZGRsZXdhcmUiLCJjdHgiLCJuZXh0IiwicHJvdGVjdGVkUHJvY2VkdXJlIiwidXNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/server/api/trpc.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0"], () => (__webpack_exec__("(api)/./node_modules/.pnpm/next@14.0.4_@babel+core@7.28.0_react-dom@18.2.0_react@18.2.0__react@18.2.0/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftrpc%2F%5Btrpc%5D&preferredRegion=&absolutePagePath=.%2Fsrc%2Fpages%2Fapi%2Ftrpc%2F%5Btrpc%5D.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();